3.1 Network time service (NTP)

- Global NTP server sits outside the application, but its role is very important
- Provides data required to synchronize the clocks of all servers in the application using NTP
- NTP server acts as a secondary synchronization source, it derives its clock data from global NTP server
- Local NTP server synchronizes all other servers in the application
- Secondary source reduces internet traffic and can help to improve security
- Ensuring servers share a common time is essential when data generated by one server is stored on another
- Example: customer orders sent from web server to the database server
- Web browsers may check to see if content has changed since previous downloading by including their local timestamp in an HTTP request
- If the file timestamps differ by more than a few seconds, content will be sent again unnecessarily

3.2 Domain name service (DNS)

- Global DNS server is the key to the way that browsers locate websites because they convert fully qualified domain names into IP addresses
- DNS relies on a hierarchical, distributed database of records about domains
- Highest level of domains are .uk, .com, and .tv and they are responsible for their sub-domains .co.uk , and .ac.uk
- Sub domain records point to another DNS server that holds info about its sub domains
- Example: DNS server for .ac.uk will hold the record for .open.ac.uk
- OPEN.AC.UK is a single organization and as such is responsible for it own DNS server to store the records of all its internet facing servers
- One of those records will be for the main website www.open.ac.uk
- As part of the process of registering a new domain name, an entry is created in the appropriate DNS server
- It can take a while for new entry to become live and filter down through the distributed database

![ioiuoi.JPG](../../_resources/ioiuoi.JPG)

- The local DNS server has another part to play in the story because it also handles any queries for IP addresses across the local network. For example, the web servers need to know how to connect to the NTP server and the load balancer needs to know how to connect to the web servers, and so on.
- To reduce the number of DNS queries made, each computer will store the results of successful queries in a temporary store (the DNS cache) and refer to the cache before starting a new DNS query. Alternatively IP addresses and fully qualified names can be stored in a local file, commonly referred to as the hosts file

**3.3 Router/NAT**

- These two functions are often combined into a single piece of equipment, such as a home router  
    **\- Router**
    - Router element fulfills two essential functions
        - First, convert low-level signals and packets of one network type into the signals and packets of another network type
            - Example: convert between the IEEE 802.3 (Ethernet) standard for wired networks and the ADSL standard that connects your home to the internet
        - Second, interconnect different networks, such as between different organizations or between departmental networks within a single organisation
            - Router is generally referred to as a gateway as it provides the gateway to other networks

**\- NAT**

- If not for NAT, every device you wanted to connect to the internet would require an IP address, and we know that there are insufficient available addresses until IPv6 is fully deployed
    - IETF set aside several blocks of IP addresses for use by any organization
    - The blocks assigned to the so-called private addresses are:
        - any address of the form 10.0.0.0 - 10.255.255.255 (16,777,216 unique addresses)
            - 10.0.0.0/8 (255.0.0.0)
        - addresses in the range 172.16.0.0 - 172.31.255.255 (1,048,576 unique addresses)
            - 172.16.0.0/12 (255.240.0.0)
        - addresses in the range 192.168.0.0 - 192.168.255.255 (65,536 unique addresses)
            - 192.168.0.0/16 (255.255.0.0)
    - Anyone can use these private addresses for their networks but the networks should not be connected to the internet
    - The way you connect to the internet with a private address is through using NAT
    - My home router has two ports: one connected to the 192.168.0.x network and one connected via ADSL to my ISPs network
    - Each port is assigned its own IP address from the range of addresses corresponding to the network
    - The ADSL port address is a true internet address, not a private address
    - Assume that my PC has address 192.168.0.2 and the default gateway of the LAN has the address 192.168.0.1
    - When I send an HTTP request to the internet, my PC detects that the destination is not on the local network so directs the corresponding IP packet to the default gateway, which is the router 192.168.0.1
    - The router detects the packets source address is private, so the packet cannot be sent out to the internet
    - The solution is to remove the local IP address from the packet and substitute the router's internet IP address
    - The local network address has been translated to an internet address, hence network address translation
    - The NAT function has another task and that is to remember which local device sent which packet to the internet
    - Typically the router saves the local source and the remote destination IP addresses in a table
    - When a response packet is received, the router uses the packets source address to look up the corresponding local address which was saved on the table
    - The destination address is changed and the response sent back to the local PC
    - To allow different connections to a single destination from different devices, the router adds a unique source port number to its own IP address to uniquely identify the TCP request message going out
    - The router then uses this port number later to send the response back to the correct device

![kjhkhjk.JPG](../../_resources/kjhkhjk.JPG)

**3.4 Firewall/DMZ**

- Firewall
    
    - The role of the firewall is to block unwanted packets of data traveling between the internet and the LAN in order to protect the servers sitting behind the firewall
        
    - Original firewalls worked by examining the IP address and port number contained within incoming packets
        
    - A packet is only allowed to cross the firewall if both the IP address and the port number are approved
        
    - This ensured that an incoming HTTP request on port 80 was directed at a web server rather than some other server
        
    - The firewall did not check the content of the request only the address and port
        
    - The second generation of firewalls extended the packet filtering to include info about the 'state' of a connection - specifically, if the packet corresponds to a new connection, an existing connection, or not part of a connection
        
    - Only packets for new and existing connections are passed through the firewall, anything else is blocked
        
    - The third generation of firewalls operate at the application layer of the network stack and are able to investigate the contents of messages for basic protocols such as HTTP, FTP, SMTP, and DNS
        
    - Messages that do not conform to the protocol or that contain inappropriate data are discarded
        
    - In addition to filtering, many modern firewalls can function as the termination point for SSL/TLS and VPN connections, off-loading the work from the servers
        
- DMZ
    
    - A firewall provides a single point of protection for a network, but it is also a single point of failure and if it fails the entire network becomes vulnerable to attacks
    - For a PC operating at home a single firewall is generally sufficient, but a more complex network requires other strategies that permit multiple levels of protection
    - DMZ stands for demilitarized zone and this is supposedly named after the demilitarized zone created between North and South Korea
    - It is an element of a network architecture that provides a wide range of protection options by means of two firewalls, an exterior firewall protecting the entire network, and an interior firewall protecting the intranet
    - The region between the two firewalls is referred to as the DMZ and it is here that externally accessible services are located  
        ![fdsafsfdf.JPG](../../_resources/fdsafsfdf.JPG)
    - The exterior firewall is the first line of defense for the network
    - It would be configured in such a way that access to the web server is permitted for all internet users, but access to the email server is limited to authenticated users, and a single external email server is used by the local email server to forward messages
    - The interior firewall blocks all unsolicited internet traffic from reaching the intranet, thereby protecting all users and all servers
    - It also blocks traffic from the servers in the DMZ from reaching the intranet, an essential requirement since these servers may be compromised

**3.5 Other elements**

- Load Balancer
    - The role of the load balancer was described in part 1
    - It can take the form of a dedicated piece of hardware or software running on another server
- Servers
    - The servers in this example are web servers in a scale-out configuration
    - If the application called for greater reliability they could be configured as a HA cluster
    - Each server requires multiple NICs: one to connect to the load balancer and another to connect to the database via the internet firewall
    - A third NIC might be employed to create a private management network that gives access to update the server software and to carry the traffic for logging server usage
    - Each server will require local disk storage for the operating system and the application software
- Database
    - The database works in conjunction with the web servers to store user credentials, purchase orders and other persistent data
    - It is protected from the web servers by an internal firewall, to restrict the IP addresses, and the ports that can exchange packets, in case a web server is compromised
- Other Options
    - Basic network architecture is far from complete and there are many other devices that could be added to improve performance
        - For example:
            - Static pages and images could be held on a caching server and delivered without a request to a web server, authentication of users could be off-loaded to a dedicated server, and encrypted communications could be handled by a dedicated piece of hardware or the load balancer

**3.6 Key points**

- The purpose in working through the traditional network architecture is to illustrate how many pieces of equipment are involved in creating a simple website
- A lot of the functionality can be provided in form of software instead of hardware these days
- Example:
    - home routers provide DNS functionality through software
- Ability to use software modules is key to success of cloud computing